@page "/"
@inject IJSRuntime jsRuntimeService

<PageTitle>The Anime Index</PageTitle>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Alexandria:wght@400;600;700&display=swap" rel="stylesheet">

<div class="container-global">

    @*Header*@
    <div class="container-header">
        <div class="header">
            <h1>The Anime Index</h1>
            <span class="subheading">the worlds largest repository of anime</span>
        </div>

        @*Search Bar*@
        <div class="container-search">
            <div class="el el--1">
                <input type="text" placeholder="Search..." @bind-value="UserInput">
            </div>
            <div class="el el--1-btn ">
                <EditForm Model="@title" OnSubmit=@FormSubmitted>
                    <button type="submit" @onclick='async () => await title.GetAnime(UserInput)'>
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#000000" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"></rect><circle cx="116" cy="116" r="84" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></circle><line x1="175.4" y1="175.4" x2="224" y2="224" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line></svg>
                    </button>
                </EditForm>
            </div>
        </div>
    </div>

    <div class="container-content">
        @*Cover Image*@
        <div class="el el--2">
            <div class="container-img">
                @if (title.Image != null)
                {
                    <img id="anime-img" src="@title.Image" alt="Anime artwork" />
                    <div id="anime-name">
                        <hr />
                        <span id="">@title.Name</span>
                    </div>
                }
            </div>
        </div>

        @*Fact Cards*@
        <div class="el el--3" onclick="touchFact(event)">
            <div class="listOfFacts">
                @((MarkupString)title.Markup!)
            </div>
        </div>
    </div>
</div>
@code {
    // User input
    [Required]
    private string? UserInput { get; set; }

    List<AnimeTitle> result = new List<AnimeTitle>();

    string? LastSubmitResult;
    AnimeTitle title = new AnimeTitle();

    // ---------------------------------------------

    void FormSubmitted(EditContext editContext)
    {
        bool formIsValid = editContext.Validate();
        LastSubmitResult =
          formIsValid
          ? "Success - form was valid"
          : "Failure - form was invalid";

        StateHasChanged();
    }
}
